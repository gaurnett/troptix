{"version":3,"names":["useEffect","useMemo","Easing","interpolateColor","runOnJS","useAnimatedProps","useDerivedValue","useSharedValue","withDelay","withTiming","useCircleValues","useAnimatedValue","initialValue","radius","maxValue","clockwise","delay","value","duration","onAnimationComplete","activeStrokeWidth","inActiveStrokeWidth","progressFormatter","v","Math","round","strokeColorConfig","undefined","animatedValue","circleCircumference","sortedStrokeColors","sort","a","b","colors","map","item","color","values","animatedCircleProps","biggestValue","max","maxPercentage","config","strokeDashoffset","strokeColor","stroke","easing","linear","isFinished","progressValue","animatedTextProps","text"],"sources":["useAnimatedValue.ts"],"sourcesContent":["import {useEffect, useMemo} from 'react';\nimport {\n  Easing,\n  interpolateColor,\n  runOnJS,\n  useAnimatedProps,\n  useDerivedValue,\n  useSharedValue,\n  withDelay,\n  withTiming,\n} from 'react-native-reanimated';\n\nimport type { StrokeColorConfigType } from '../types';\n\nimport useCircleValues from './useCircleValues';\n\nexport interface UseAnimatedValueProps {\n  value: number;\n  initialValue?: number;\n  radius?: number;\n  duration?: number;\n  delay?: number;\n  maxValue?: number;\n  onAnimationComplete?: () => void;\n  activeStrokeWidth?: number;\n  inActiveStrokeWidth?: number;\n  clockwise?: boolean;\n  valueSuffix?: string;\n  valuePrefix?: string;\n  // eslint-disable-next-line no-unused-vars\n  progressFormatter?: (v: number) => number | string;\n  strokeColorConfig?: StrokeColorConfigType[];\n}\n\ntype Config = {\n  strokeDashoffset: number;\n  stroke?: string | number;\n};\n\nexport default function useAnimatedValue({\n  initialValue = 0,\n  radius = 60,\n  maxValue = 100,\n  clockwise,\n  delay = 0,\n  value,\n  duration,\n  onAnimationComplete = () => null,\n  activeStrokeWidth = 10,\n  inActiveStrokeWidth = 10,\n  progressFormatter = (v: number) => {\n    'worklet';\n\n    return Math.round(v);\n  },\n  strokeColorConfig = undefined,\n}: UseAnimatedValueProps) {\n  const animatedValue = useSharedValue(initialValue);\n  const { circleCircumference } = useCircleValues({\n    radius,\n    activeStrokeWidth,\n    inActiveStrokeWidth,\n  });\n\n  const sortedStrokeColors = useMemo(() => {\n    if (!strokeColorConfig) {return null;}\n    return strokeColorConfig.sort((a, b) => a.value - b.value);\n  }, [strokeColorConfig]);\n\n  const colors = useMemo(() => {\n    if (!sortedStrokeColors) {return null;}\n    return sortedStrokeColors.map((item) => item.color);\n  }, [sortedStrokeColors]);\n\n  const values = useMemo(() => {\n    if (!sortedStrokeColors) {return null;}\n    return sortedStrokeColors.map((item) => item.value);\n  }, [sortedStrokeColors]);\n\n  const animatedCircleProps = useAnimatedProps(() => {\n    let biggestValue: number = Math.max(initialValue, maxValue);\n    biggestValue = biggestValue <= 0 ? 1 : biggestValue;\n    const maxPercentage: number = clockwise\n      ? (100 * animatedValue.value) / biggestValue\n      : (100 * -animatedValue.value) / biggestValue;\n      const config: Config = {\n        strokeDashoffset:\n          circleCircumference - (circleCircumference * maxPercentage) / 100,\n      };\n      const strokeColor =\n        colors && values\n          ? interpolateColor(animatedValue.value, values, colors)\n          : undefined;\n      if (strokeColor) {\n        config.stroke = strokeColor;\n      }\n      return config;\n  });\n\n  useEffect(() => {\n    animatedValue.value = withDelay(\n      delay,\n      withTiming(value, { duration, easing: Easing.linear }, (isFinished) => {\n        if (isFinished) {\n          runOnJS(onAnimationComplete)?.();\n        }\n      })\n    );\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n\n  const progressValue = useDerivedValue(() => {\n    return `${progressFormatter(animatedValue.value)}`;\n  });\n\n  const animatedTextProps = useAnimatedProps(() => {\n    return {\n      text: progressValue.value,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    } as any; // eslint-disable-line prettier/prettier\n  });\n\n  return {\n    animatedCircleProps,\n    animatedTextProps,\n    progressValue,\n  };\n}\n"],"mappings":"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"}